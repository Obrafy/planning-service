FROM golang:1.17.6-bullseye

ENV AWS_ACCESS_KEY_ID=AKIAYHOCMN6C7Z72QM4D
ENV AWS_SECRET_ACCESS_KEY=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

ENV APP_HOME /go/src/app
ENV APP_PATH "$APP_HOME"/bin/<PLATFORM>-<ARCHITECTURE>/app

RUN mkdir -p "$APP_HOME"

COPY . "$APP_HOME"

WORKDIR "$APP_HOME"

RUN ./build.bash <PLATFORM> <ARCHITECTURE>

ENTRYPOINT ["/go/src/app/bin/<PLATFORM>-<ARCHITECTURE>/app"] 
